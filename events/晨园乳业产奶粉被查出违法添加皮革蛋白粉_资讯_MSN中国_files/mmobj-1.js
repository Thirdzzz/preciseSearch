if(Array.prototype.push==null){Array.prototype.push=function(a){this[this.length]=a;return this.length}}if(typeof cn=="undefined"){var cn=new Object()}if(typeof cn.diny=="undefined"){cn.diny=new Object()}if(typeof cn.diny.dom=="undefined"){cn.diny.dom=new Object()}cn.diny.RotateMMAds={co:Array(),urlTracker:"1.js",urlEnd:"2.js",pos:0,debug:true,rootURL:"",getDumpCode:function(c){var b="";var a=cn.diny.RotateMMAds;if(a.debug){return'document.write("<!-- '+c+' -->\\n");\n'}return b},getNextCode:function(){var a="";a+="cn.diny.RotateMMAds.pos++;\n";a+="cn.diny.RotateMMAds.writeCurrentFragment();\n";a+="cn.diny.RotateMMAds.invoke();\n";return a},getCompleteCode:function(){var a="";a+="cn.diny.RotateMMAds.writeEndCode();\n";return a},getInternelUrl:function(b){var a="<div style='position: absolute; visibility: hidden; top: 0px; left: 0px'>";a+="<img style='width: 0px; height: 0px' alt='' src='"+b+"' width=0 height=0/>";a+="</div>";return a},evalCallback:function(current){var code="";if(current.callbackViewURL!=""){code+=current.callback+" = function() {\n";code+='   new Image().src = "'+current.callbackViewURL+'";\n';code+="};\n";eval(code)}},writeCurrentFragment:function(){var a=cn.diny.RotateMMAds;var d=a.co.length;var c;var b="";if(a.pos>=d||a.pos<0){return}c=a.co[a.pos];a.generateSnap();document.write(c.fragment);if(c.callback!=""){a.evalCallback(c)}},writeJsLevel:function(){var a=cn.diny.RotateMMAds;var b=a.urlTracker;if(a.rootURL!=""){b=a.rootURL+"/"+b}document.write("<script src='"+b+"' type='text/javascript'><\/script>")},writeEndCode:function(){var b=cn.diny.RotateMMAds;var a=b.urlEnd;if(b.rootURL!=""){a=b.rootURL+"/"+a}document.write("<script src='"+a+"' type='text/javascript'><\/script>")},generateSnap:function(){var d=cn.diny.RotateMMAds;d.trDefault=Array();d.trSpan=Array();d.trFlashArr=Array();var f=document.getElementsByTagName("div");for(var c=0,e=f.length;c<e;++c){var a=f[c];var b=0;if(a.style.zIndex){b=parseInt(a.style.zIndex);if(b>d.trZIndex){d.trDefault.push(a)}}}f=document.getElementsByTagName("span");for(var c=0,e=f.length;c<e;++c){var a=f[c];var b=0;if(a.style.zIndex){b=parseInt(a.style.zIndex);if(b>d.trZIndex){d.trSpan.push(a)}}}f=document.getElementsByTagName("object");for(var c=0,e=f.length;c<e;++c){var a=f[c];var b=0;if(a.style.zIndex){b=parseInt(a.style.zIndex);if(b>d.trZIndex){d.trFlashArr.push(a)}}}},trDefault:Array(),trFlashArr:Array(),trSpan:Array(),trZIndex:1,trMinRMax:150,trMinRMin:5,trFixedMin:-10,trMinFlash:5,trFlash:function(g){var c=cn.diny.RotateMMAds;var f=Array();var e=g.getElementsByTagName("object");for(var b=0,d=e.length;b<d;++b){var a=e[b];if(a.style.display&&a.style.display=="none"){continue}f.push(a)}return f},trNewCo:function(e,k){var m=Array();var g=cn.diny.RotateMMAds;for(var d=0,a=k.length;d<a;++d){var f=k[d];var b=0;if(f.style.zIndex){b=parseInt(f.style.zIndex);if(b>g.trZIndex&&(!f.style.display||f.style.display!="none")&&(!f.style.visibility||f.style.visibility!="hidden")&&(f.style.position&&(f.style.position=="absolute"||f.style.position=="fixed"))){var l=false;for(var c=0,h=e.length;c<h;++c){if(e[c]==f){l=true;break}}if(l){continue}m.push(f)}}}return m},trCheck:function(a,t){var u=cn.diny.RotateMMAds;var n=null;var r=0;var x=false;var l=false;var f=0;var j=u.trNewCo(a,t);for(var s=0,b=j.length;s<b;++s){var g=j[s];var h=0;var w=0;var k=0;var d=0;var v=0;var c=0;var p=g.offsetWidth;var e=g.offsetHeight;if(p<u.trMinRMin||e<u.trMinRMin){continue}if(window.innerWidth){v=window.innerWidth;c=window.innerHeight}else{if(document.documentElement.clientWidth){v=document.documentElement.clientWidth;c=document.documentElement.clientHeight}else{v=screen.availWidth;c=screen.availHeight}}if(g.style.bottom){h=parseInt(g.style.bottom)}if(g.style.right){w=parseInt(g.style.right)}if(g.style.top){k=parseInt(g.style.top)}if(g.style.left){d=parseInt(g.style.left)}var q=0;var m=0;if(d!=0){if(d>0){q=v-d;if(q>p){q=p}}else{q=p+d}if(q<0){q=0}}else{if(w!=0){if(w>0){if(w<v){q=p}}else{q=p+w}if(q<0){q=0}}else{q=p}}if(k!=0){if(k>0){m=c-k;if(m>e){m=e}}else{m=e+k}if(m<0){m=0}}else{if(h!=0){if(h>0){if(h<c){m=e}}else{m=e+h}if(m<0){m=0}}else{m=e}}var o=0;if(q!=0&&m!=0){o=q>m?m:q}else{if(q!=0){o=q}else{if(m!=0){o=m}}}if(o>u.trMinRMax){x=true;if(g.id){f=g.id}break}else{if(o>u.trMinRMin){l=true;if(g.id){f=g.id}break}}}if(x||l){n={};n.isPlay=x;n.isMini=l;n.divId=f}return n},trCheckAll:function(){var b=cn.diny.RotateMMAds;var a=null;var c=document.getElementsByTagName("div");a=b.trCheck(b.trDefault,c);if(!a){c=document.getElementsByTagName("span");a=b.trCheck(b.trSpan,c);if(!a){c=document.getElementsByTagName("object");a=b.trCheck(b.trFlashArr,c)}}return a},trackPlayTim:function(){var b=cn.diny.RotateMMAds;var e=b.co.length;if(b.pos>=e||b.pos<0){return}var d=b.co[b.pos];var c=true;d.playTim+=5;var a=b.trCheckAll();if(d.playTim==5){if(a&&a.isPlay){if(d.playTim5!=""){new Image().src=d.playTim5+"&mid="+a.divId;d.playTim5=""}}else{c=false}}if(d.playTim==10){if(a&&a.isPlay){if(d.playTim10!=""){new Image().src=d.playTim10+"&mid="+a.divId;d.playTim10=""}}else{c=false}}if(d.playTim==15){if(a&&a.isPlay){if(d.playTim15!=""){new Image().src=d.playTim15+"&mid="+a.divId;d.playTim15=""}}else{c=false}}if(c&&d.playTim<15){setTimeout(function(){cn.diny.RotateMMAds.trackPlayTim()},5000)}},trackPlayMin:function(){var b=cn.diny.RotateMMAds;var e=b.co.length;if(b.pos>=e||b.pos<0){return}var d=b.co[b.pos];var c=false;var a=b.trCheckAll();if(d.playTimMin!=""){c=true;if(a&&a.isMini){new Image().src=d.playTimMin+"&mid="+a.divId;d.playTimMin=""}}if(c){setTimeout(function(){cn.diny.RotateMMAds.trackPlayMin()},50)}},afterRealPlay:function(){var a=cn.diny.RotateMMAds;var c=a.co.length;if(a.pos>=c||a.pos<0){return}var b=a.co[a.pos];setTimeout(function(){cn.diny.RotateMMAds.trackFirstPlay()},a.trackFirstPlayTime);b.playTim=0;setTimeout(function(){cn.diny.RotateMMAds.trackPlayTim()},5000);setTimeout(function(){cn.diny.RotateMMAds.trackPlayMin()},50)},trackMiniPlay:function(){var b=cn.diny.RotateMMAds;var d=b.co.length;if(b.pos>=d||b.pos<0){return}var c=b.co[b.pos];var a=b.trCheckAll();if(c.miniPlayURL!=""){if(a&&a.isPlay){new Image().src=c.miniPlayURL+"&mid="+a.divId;c.miniPlayURL="";b.afterRealPlay()}setTimeout(function(){cn.diny.RotateMMAds.trackMiniPlay()},50)}},trackPlay:function(){var b=cn.diny.RotateMMAds;var e=b.co.length;var c=false;if(b.pos>=e||b.pos<0){return}var d=b.co[b.pos];var a=b.trCheckAll();if(d.playURL!=""){c=true;if(a&&a.isPlay){new Image().src=d.playURL+"&mid="+a.divId;d.playURL="";d.miniURL="";b.afterRealPlay()}}if(d.miniURL!=""){c=true;if(a&&a.isMini){new Image().src=d.miniURL+"&mid="+a.divId;d.miniURL="";d.playURL="";if(d.miniPlayURL!=""){b.trackMiniPlay()}}}if(c){setTimeout(function(){cn.diny.RotateMMAds.trackPlay()},50)}},trackFirstPlayTime:500,trackFirstPlay:function(){var b=cn.diny.RotateMMAds;var e=b.co.length;var c=false;if(b.pos>=e||b.pos<0){return}var d=b.co[b.pos];var a=b.trCheckAll();if(d.playURL1!=""){c=true;if(a&&a.isPlay){new Image().src=d.playURL1+"&mid="+a.divId;d.playURL1="";setTimeout(function(){cn.diny.RotateMMAds.trackSecondPlay()},b.trackSecondPlayTime)}}if(c){setTimeout(function(){cn.diny.RotateMMAds.trackFirstPlay()},50)}},trackSecondPlayTime:2000,trackSecondPlay:function(){var b=cn.diny.RotateMMAds;var e=b.co.length;var c=false;if(b.pos>=e||b.pos<0){return}var d=b.co[b.pos];var a=b.trCheckAll();if(d.playURL2!=""){c=true;if(a&&a.isPlay){new Image().src=d.playURL2+"&mid="+a.divId;d.playURL2=""}}if(c){setTimeout(function(){cn.diny.RotateMMAds.trackSecondPlay()},50)}},trackOnLoadPlay:function(){var b=cn.diny.RotateMMAds;var e=b.co.length;var c=false;if(b.pos>=e||b.pos<0){return}var d=b.co[b.pos];var a=b.trCheckAll();if(d.playURL3!=""){c=true;if(a&&a.isPlay){new Image().src=d.playURL3+"&mid="+a.divId;d.playURL3=""}}if(c){setTimeout(function(){cn.diny.RotateMMAds.trackOnLoadPlay()},50)}},complete:function(){var a=cn.diny.RotateMMAds;var c=a.co.length;var b;if(a.pos>=c||a.pos<0){return}b=a.co[a.pos];if(b.actionURL!=""){document.write(a.getInternelUrl(b.actionURL))}a.trackPlay();if(window.attachEvent){window.attachEvent("onload",this.trackOnLoadPlay)}else{if(window.addEventListener){window.addEventListener("load",this.trackOnLoadPlay,false)}}},invoke:function(){var _this_=cn.diny.RotateMMAds;var lenth=_this_.co.length;var current;var magicScript;if(_this_.pos>=lenth||_this_.pos<0){return}current=_this_.co[_this_.pos];current.run_once();if(!current.isVariant){eval(_this_.getDumpCode("MMOBJ(D) No Variant"));_this_.writeEndCode();return}if(current.variant==""){return}if(current.offs<current.level){current.offs+=1;_this_.writeJsLevel();return}magicScript="";magicScript+="if(typeof  "+current.variant+' == "undefined"){\n';if(current.conditionUndefined){magicScript+=_this_.getDumpCode("MMOBJ(N) "+current.variant+" undefined");magicScript+=_this_.getNextCode()}else{magicScript+=_this_.getDumpCode("MMOBJ(D) "+current.variant+" undefined");magicScript+=_this_.getCompleteCode()}magicScript+="} else {\n";magicScript+="    if("+current.variant+"==true){\n";if(current.condition){magicScript+=_this_.getDumpCode("MMOBJ(N) "+current.variant+"==true");magicScript+=_this_.getNextCode()}else{magicScript+=_this_.getDumpCode("MMOBJ(D) "+current.variant+"==true");magicScript+=_this_.getCompleteCode()}magicScript+="    } else {\n";if(current.condition){magicScript+=_this_.getDumpCode("MMOBJ(D) "+current.variant+"==false");magicScript+=_this_.getCompleteCode()}else{magicScript+=_this_.getDumpCode("MMOBJ(N) "+current.variant+"==false");magicScript+=_this_.getNextCode()}magicScript+="    }\n";magicScript+="}\n";eval(magicScript)},add:function(b){var a=cn.diny.RotateMMAds;a.co.push(b)},display:function(){var f=cn.diny.RotateMMAds;var e=f.co;var d,b;var h=e.length;for(d=0;d<h-1;++d){var a=d;var g=e[d];var c=g.priority;for(b=d+1;b<h;++b){if(e[b].priority>c){a=b;c=e[b].priority}}if(a!=d){g=e[d];e[d]=e[a];e[a]=g}}f.writeCurrentFragment();f.invoke()}};cn.diny.RotateMMAd=function(a){this.priority=1;this.isVariant=false;this.variant="";this.level=1;this.condition=true;this.conditionUndefined=true;this.offs=0;this.fragment=a;this.viewURL="";this.actionURL="";this.callbackViewURL="";this.callback="";this.playURL="";this.miniURL="";this.miniPlayURL="";this.playURL1="";this.playURL2="";this.playURL3="";this.playTim=0;this.playTim5="";this.playTim10="";this.playTim15="";this.playTimMin="";this.initrun=false};cn.diny.RotateMMAd.prototype={run_once:function(){if(!this.initrun){if(this.viewURL!=""){document.write(cn.diny.RotateMMAds.getInternelUrl(this.viewURL))}this.initrun=true}}};